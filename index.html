<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>BamM - Working with the BAM</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="./css/docs.css" rel="stylesheet">
  </head>

  <body class="preview" data-spy="scroll" data-target=".subnav" data-offset="80">
    <script src="./js/bsa.js"></script>

    <div class="container">

<br>
<header class="jumbotron subhead" id="overview">
  <div class="row">
    <img style="display: block; margin-left: auto; margin-right: auto;" src="./img/bamm_logo_sm.png"/>
  </div>
</header>


<section id="theboss">
  <!-- Headings & Paragraph Copy -->
  <div class="row">
    <div class="span4">
        <hr>
        <h1>Get BamM</h1>
        <p>I use and love Linux and BamM has been developed to work on a Linux system. I'm not saying it won't work elsewhere, but I haven't tried. YMMV. People have successfully used BamM on many different flavours of Linux as well as on Mavericks 10.9. If you try it somewhere else then let me know. I'd like to keep this list up to date.</p>
        <p>The installation for BamM is a little more complicated than just using pip. Please see the <a href="manual/BamM_manual.pdf">manual</a> for detailed installation instructions, including dependencies.</p>
        <p>Source code for BamM is available <a href="http://www.github.com/minillinim/BamM.git">here</a></p>
        <hr>
        <h1>Licensing</h1>
        <p>BamM is licensed using the Lesser GNU General Public License version 3 as published by the Free Software Foundation.</p>
        <p>This site and the BamM logo are copyright Mike Imelfort</p>
        <p>This site was created using a template created by the wonderful people at <a href="http://bootswatch.com">bootswatch</a>.
    </div>
    <div class="span4">
        <hr>
        <h1>Use BamM</h1>
        <p>The primary motivation for building BamM was to replaace PySam in GroopM. Not saying PySam is bad, it's just that GroopM doesn't need all the PySam features and what it does need can be done way way faster in C-land.</p>
        <p>From there, BamM was developed to be used as a command line tool and as a python library. Detailed information on the former can be found in our new, ever more detailed <a href="manual/BamM_manual.pdf">manual</a>. To use BamM as a library check out the <a href="dev_docs/index.html">development api</a>. If you're feeling rushed then read on:</p>
        <p>BamM on the command line is run in three modes:</p>
        <ul>
          <li><strong>make</strong> - Make a bunch of BAM files by mapping several read sets against a common reference sequence</li>
          <li><strong>parse</strong> - Examine the BAMs to produce coverage profiles or linking information</li>
          <li><strong>extract</strong> - Extract reads that map to some given collections of contigs</li>
        </ul>
        <p>BamM was designed to be as parameter-free as possible. For more information on these steps type:</p>
        <p>$ bamm OPTION -h</p>
    </div>
    <div class="span4">
        <hr>
        <h1>Cite BamM</h1>
        <p>If you use this software then we'd love you to cite us. Unfortunately that's impossible right now, but there is a paper just around the corner. Please contact Mike Imelfort. m_dot_imelfort_at_uq_dot_edu_dot_au for more information</p>
        <hr>
        <h1>Talk to us</h1>
        <p>All BamM related suggestions, criticisms or abuse should be directed to Mike Imelfort. m_dot_imelfort_at_uq_dot_edu_dot_au</p>
    </div>
  </div>
  <hr>
  <div class="row">
    <div class="span12">
      <h1>Issues...?</h1>
      <p>Several people are having very similar issues with BamM so I thought I'd provide some information here for those having trouble running BamM (or something that uses BamM, like GroopM). I try to fix bugs when people tell me about them so it may be the case that your problem is fixed. So first, make sure BamM is at the latest version.

      A common error people see with BamM and GroopM looks something like this:

        <pre><code>
[[GroopM 0.3.3]] Running in data parsing mode...
*******************************************************************************
Creating new database science_stuff.gm
Parsing contigs
Parsing BAM files using 1 threads
Traceback (most recent call last):
  File "/usr/local/bin/groopm", line 381, in <module>
    GM_parser.parseOptions(args)
  File "/usr/local/lib/python2.7/dist-packages/groopm/groopm.py", line 117, in parseOptions
    threads=options.threads)
  File "/usr/local/lib/python2.7/dist-packages/groopm/mstore.py", line 276, in createDB
    threads)
  File "/usr/local/lib/python2.7/dist-packages/groopm/mstore.py", line 1773, in parse
    return ([BP.BFI.bamFiles[i].fileName for i in range(len(bamFiles))],
<strong>IndexError: list index out of range</strong>
        </code></pre>

        The IndexError is a red herring. the problem is that the C code contained within BamM is crashing silently and the contents of an output list are not being filled. Unfortunately, there's no way for me or my code (as far as I know right now) to see when this happens, so everything keeps chugging along, right off the cliff. It's very frustrating. The most likely reason for this type of error is that your python version or some packages on your system are too old. Before you email, please download <a href="./aux/sysInfo.py.gz">this</a> script and run it on the system you're trying to run BamM on like this:
        <pre><code>
$ wget http://minillinim.github.io/BamM/aux/sysInfo.py.gz
$ gunzip sysInfo.py.gz
$ chmod +x sysInfo.py
$ ./sysInfo.py
        </code></pre>
        This will print a bunch of information to the screen. Please send this to me in your email. On my system, which runs BamM well, this outputs the following:
        <pre><code>
Tables version: 3.1.1
Location: /usr/local/lib/python2.7/dist-packages/tables/__init__.pyc
Numpy version: 1.7.1
Location: /usr/local/lib/python2.7/dist-packages/numpy/__init__.pyc
Scipy version: 0.12.1
Location: /usr/local/lib/python2.7/dist-packages/scipy/__init__.pyc
MPL version: 1.3.0
Location: /usr/local/lib/python2.7/dist-packages/matplotlib/__init__.pyc
Linux 3.13.0-43-generic
2.7.6 (default, Mar 22 2014, 22:59:56) 
[GCC 4.8.2]
['/home/uqmimelf/working/tmp', '/usr/local/lib/python2.7/dist-packages/distribute-0.7.3-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/setuptools-1.1.6-py2.7.egg', '/usr/local/lib/python2.7/dist-packages/concoct-0.2.1-py2.7-linux-x86_64.egg', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-x86_64-linux-gnu', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PILcompat', '/usr/lib/python2.7/dist-packages/gst-0.10', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/pymodules/python2.7', '/usr/lib/python2.7/dist-packages/ubuntu-sso-client', '/usr/lib/python2.7/dist-packages/wx-2.8-gtk2-unicode']
        </code></pre>
        Don't worry about the Tables and matplotlib stuff. It's there because I use the same script for debugging GroopM issues too. The versions I have here are the ones I test against. If yours are older then it might be in your best interest to try upgrade them.
        If your software is up to data and you still get the index error then the most likely reason for your error is that BamM is not properly installed. When you install BamM it needs to compile some C code. To do this it needs to know where htslib and libcfu are. Specifically, you should look for this in the output when you install BamM:
        <pre><code>
checking whether g++ accepts -g... yes
checking for lgamma,log,exp in -lm... yes
checking for libcfu headers in /home/uqmimelf/local/opt/libcfu-0.03/include... <strong>found</strong>
checking for libcfu libraries in /home/uqmimelf/local/opt/libcfu-0.03/lib... <strong>found</strong>
checking for libhts headers in /home/uqmimelf/local/opt/htslib... <strong>found</strong>
checking for libhts libraries in /home/uqmimelf/local/opt/htslib... <strong>found</strong>
configure: creating ./config.status
config.status: creating Makefile
config.status: creating config.h
config.status: config.h is unchanged
rm -f bamParser
rm -f bamExtractor
rm -f *.o
rm -f libBamM.a
gcc -g -fPIC -pthread -O2 -Wall -I/home/uqmimelf/local/opt/htslib -I/home/uqmimelf/local/opt/libcfu-0.03/include  -c -o bamExtractor.o bamExtractor.c
gcc -g -fPIC -pthread -O2 -Wall -I/home/uqmimelf/local/opt/htslib -I/home/uqmimelf/local/opt/libcfu-0.03/include  -c -o bamParser.o bamParser.c
gcc -g -fPIC -pthread -O2 -Wall -I/home/uqmimelf/local/opt/htslib -I/home/uqmimelf/local/opt/libcfu-0.03/include  -c -o pairedLink.o pairedLink.c
gcc -g -fPIC -pthread -O2 -Wall -I/home/uqmimelf/local/opt/htslib -I/home/uqmimelf/local/opt/libcfu-0.03/include  -c -o bamRead.o bamRead.c
gcc -g -fPIC -pthread -O2 -Wall -I/home/uqmimelf/local/opt/htslib -I/home/uqmimelf/local/opt/libcfu-0.03/include  -c -o coverageEstimators.o coverageEstimators.c
gcc -g -fPIC -pthread -O2 -Wall -I/home/uqmimelf/local/opt/htslib -I/home/uqmimelf/local/opt/libcfu-0.03/include -static-libgcc -shared -Wl,-rpath,/home/uqmimelf/local/opt/htslib -o libBamM.a bamExtractor.c bamParser.c pairedLink.c bamRead.c coverageEstimators.c -lm -L/home/uqmimelf/local/opt/libcfu-0.03/lib -lcfu -L/home/uqmimelf/local/opt/htslib -lhts
Building library
/usr/lib/python2.7/distutils/dist.py:267: UserWarning: Unknown distribution option: 'install_requires'
  warnings.warn(msg)
running install
running build
running build_py
running build_scripts
running install_lib
running install_scripts
changing mode of /usr/local/bin/bamm to 755
changing mode of /usr/local/bin/bamFlags to 755
running install_data
<strong>copying c/libBamM.a -> /usr/local/lib/python2.7/dist-packages/bamm/c/</strong>
running install_egg_info
Removing /usr/local/lib/python2.7/dist-packages/BamM-1.3.3.egg-info
Writing /usr/local/lib/python2.7/dist-packages/BamM-1.3.3.egg-info

        </code></pre>
        If there are any "not found"s then the library will not be built and BamM will not run. If there is any error copying "c/libBamM.a" then BamM will not run. Almost any error in the compilation stage will cause heartache downstream. So finally, if you're having trouble with GroopM/BamM then please work out if it's one of the two issues mentioned here. If it's the "double free" one then please run the <a href="./aux/sysInfo.py.gz">sysInfo script</a> and send me the output. If it's another error then please try to reinstall BamM and check for any errors or problems with the install. If this all looks sound then please send me the install log (stuff that prints to the screen) and also the results of <a href="./aux/sysInfo.py.gz">sysInfo.py</a>.

     Thanks!
      </p>
    </div>
  </div>
</section>
<hr>

    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
  </body>
</html>

